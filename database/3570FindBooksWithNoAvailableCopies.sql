SELECT L.book_id, L.title, L.author, L.genre, L.publication_year, if(L.total_copies - (count(*) - count(return_date)) = 0, L.total_copies, 0) as 'current_borrowers' from library_books L join borrowing_records B on B.book_id = L.book_id group by L.book_id, L.title, L.author, L.genre, L.publication_year, L.total_copies having current_borrowers > 0 order by current_borrowers desc, title asc;